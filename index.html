<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Losowanie sÅ‚Ã³wek</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body id="pageBody">
  <header>
    <h1>ğŸ“ Losuj sÅ‚Ã³wka i poznawaj jÄ™zyki Europy!</h1>
  </header>

  <main>
    <section class="controls">
      <label for="fromLang">JÄ™zyk ÅºrÃ³dÅ‚owy:</label>
      <select id="fromLang" onchange="updateTheme()">
        <option value="pl">Polski</option>
        <option value="ua">UkraiÅ„ski</option>
        <option value="en">Angielski</option>
        <option value="it">WÅ‚oski</option>
      </select>

      <label for="toLang">JÄ™zyk docelowy:</label>
      <select id="toLang" onchange="updateTheme()">
        <option value="pl">Polski</option>
        <option value="ua">UkraiÅ„ski</option>
        <option value="en">Angielski</option>
        <option value="it">WÅ‚oski</option>
      </select>

      <br />
      <button onclick="drawWord()">Wylosuj sÅ‚owo</button>
    </section>

    <div id="wordBox" class="word-box"></div>

    <div class="quiz-section">
      <h3>Mini Quiz</h3>
      <div id="quizBox"></div>
    </div>

    <div class="culture-box" id="cultureBox">
      ğŸŒ Poznawaj jÄ™zyki i kultury Europy!
    </div>
  </main>

  <footer>
    Â© 2025 Twoja strona jÄ™zykowa
  </footer>

  <script>
    let wordPairs = {};

    async function loadWordPairs(from, to) {
      const key = `${from}_${to}`;
      try {
        const response = await fetch(`slowniki/${key}.json`);
        if (!response.ok) throw new Error("Nie udaÅ‚o siÄ™ zaÅ‚adowaÄ‡ pliku.");
        wordPairs[key] = await response.json();
        return wordPairs[key];
      } catch (e) {
        console.error(e);
        return [];
      }
    }

    function updateTheme() {
      const from = document.getElementById("fromLang").value;
      const cultureBox = document.getElementById("cultureBox");
      const cultureFacts = {
        pl: "ğŸ‡µğŸ‡± Polska sÅ‚ynie z pierogÃ³w i noblistki Marii SkÅ‚odowskiej-Curie.",
        ua: "ğŸ‡ºğŸ‡¦ Ukraina ma alfabet z 33 literami i tradycyjne hafty â€“ wyszywanki.",
        en: "ğŸ‡¬ğŸ‡§ Anglia to Big Ben i herbata o 17:00.",
        it: "ğŸ‡®ğŸ‡¹ WÅ‚ochy to kraj pizzy i opery."
      };
      cultureBox.innerText = cultureFacts[from] || "ğŸŒ Poznawaj jÄ™zyki i kultury Europy!";
    }

    async function drawWord() {
      const from = document.getElementById("fromLang").value;
      const to = document.getElementById("toLang").value;
      const key = `${from}_${to}`;
      const box = document.getElementById("wordBox");
      const quizBox = document.getElementById("quizBox");

      let list = wordPairs[key];
      if (!list) {
        list = await loadWordPairs(from, to);
      }

      if (!list || list.length === 0) {
        box.innerHTML = "<p>Brak danych dla tej kombinacji jÄ™zykÃ³w.</p>";
        quizBox.innerHTML = "";
        return;
      }

      const word = list[Math.floor(Math.random() * list.length)];
      box.innerHTML = `
        <p><strong>SÅ‚owo:</strong> ${word.word}</p>
        <p><strong>TÅ‚umaczenie:</strong> ${word.translation}</p>
        <p><strong>Definicja:</strong> ${word.definition}</p>
        <p><strong>PrzykÅ‚ad:</strong> ${word.example}</p>
      `;

      renderQuiz(word);
    }

    function renderQuiz(word) {
      const correct = word.translation;
      const distractors = ["woda", "ciaÅ‚o", "lekarstwo", "bÃ³l"];
      const options = [...new Set([correct, ...distractors])].sort(() => Math.random() - 0.5);

      const quizBox = document.getElementById("quizBox");
      quizBox.innerHTML = "<p>Wybierz poprawne tÅ‚umaczenie:</p>";
      options.forEach(option => {
        const btn = document.createElement("button");
        btn.innerText = option;
        btn.onclick = () => {
          quizBox.innerHTML = option === correct
            ? "<p>âœ… Brawo! To poprawna odpowiedÅº!</p>"
            : `<p>âŒ Niepoprawnie. PrawidÅ‚owa odpowiedÅº to: ${correct}</p>`;
        };
        quizBox.appendChild(btn);
      });
    }
  </script>
</body>
</html>
